@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    ViewData["Title"] = "Create";
    
}
@model DeskModel.Models.Desk
<div id="statusmessageid">
</div>
        
@*<div id="displaylocationnameid">
</div>*@
<div class="row">
    <div class="col-md-4">
        <form asp-action="Edit">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            <div class="form-group">
                <label asp-for="name" class="control-label"></label>
                <input asp-for="name" id="desknameinput" class="form-control" />
                <span asp-validation-for="name" class="text-danger"></span>
            </div>
           @* <input asp-for="id" type="hidden" value="@Model.id" />
           *@ <input asp-for="id" id="deskidinput" type="hidden" value="@Model.id" />
            <div class="form-group">
                @Html.LabelFor(model => model.locationKey, "locationKey", htmlAttributes: new { @class = "control-label col-md-2" })
                <div class="col-md-10">
                    @Html.DropDownList("locationKey", null, htmlAttributes: new { @class = "form-control" })
                    @Html.ValidationMessageFor(model => model.locationKey, "", new { @class = "text-danger" })
                </div>
            </div>
            <div class="form-group">
                <input type="submit" value="Edit" class="btn btn-primary" />
            </div>
        </form>
        

    </div>
</div>
@*<select id="locationsid"></select>-
<button id="setlocationid">set location</button>
<button id="removelocationid">remove location</button>*@
<div>
    <a asp-action="Index">Back to List</a>
</div>

@section scripts {

   
    

    <script type="text/javascript">
        /*
        var $selectLocs;
   
    function ReadDeskLocation(data)
    {
            $('#displaylocationnameid').html("desk location: "+data.name)
            $('#displaylocationnameid').addClass("alert-success")
            
    }
        $(document).ready(function () {
            Log1();
            //var id = $('#deskidinput').val()
            var id = @Model.id;
            GetAJAX('/Admin/Desk2/AjaxLoadRelatedLocation/' + id, 'GET', ReadDeskLocation, FailEmpty);

        });
    function DeleteDeskLocation(data)
    {
            $('#displaylocationnameid').html("desk location: none")
            $('#displaylocationnameid').addClass("alert-success")
            $('#statusmessageid').html(data.message)
            if (data.hasSucceeded==true)
                $('#statusmessageid').addClass("alert-success");
            else
                $('#statusmessageid').addClass("alert-danger");

    }
    function SetDeskSuccess(data)
    {
        var id = $('#deskidinput').val()
        GetAJAX('/Admin/Desk2/AjaxLoadRelatedLocation/'+id, 'GET', ReadDeskLocation, FailEmpty);
        console.log(data)
        $('#statusmessageid').html(data.message)
        if (data.hasSucceeded == true)
            $('#statusmessageid').addClass("alert-success");
        else
            $('#statusmessageid').addClass("alert-danger");
    }
        $(document).ready(function () {

            $("#setlocationid").on("click", function () {
                var deskdto = {}
                deskdto.deskname = $("#desknameinput").val();
                deskdto.deskid = $("#deskidinput").val();
                deskdto.locationid = $selectLocs[0].selectize.getValue();
                //postAJAX('/Admin/Desk2/AjaxPostDesks', 'GET', FillSelectizeContent, FailEmpty);

                console.log(deskdto);
                PostAJAX('/Admin/Desk2/AjaxPostLocation','POST',SetDeskSuccess,FailEmpty,deskdto);
                //return
                
            });

            $("#removelocationid").on("click", function () {
                
                    var deskdto = {}
                    deskdto.deskname = $("#desknameinput").val();
                    deskdto.deskid = $("#deskidinput").val();
                    deskdto.locationid = null;
                PostAJAX('/Admin/Desk2/AjaxDeleteLocation', 'POST', DeleteDeskLocation, FailEmpty, deskdto);


            });
            
            $selectLocs = $('#locationsid').selectize({
                valueField: 'id',
                labelField: 'name',
                searchField: ['name'],
                sortField: 'name',
                onInitialize: function () {
                    //loadLocationsAJAX();
                    GetAJAX('/Admin/Desk2/AjaxGetDesks', 'GET', FillSelectizeContent, FailEmpty);
                    console.log("hello from selectize")
                },
                render: {
                    option: function (item, escape) {
                        console.log("i am in selectize render function")
                        return '<div class="selectDiv">' +
                            '<span class="mainName">' + escape(item.name) + '</span > <br />' +
                            '</div>';
                    }
                }
            })

            console.log("ready!");
            $("#jquerytestitem").html("hello from js");

        });
        */
    </script>

        
}

